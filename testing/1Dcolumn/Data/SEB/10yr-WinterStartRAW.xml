<ParameterList name="Main">
  <Parameter name="Native Unstructured Input" type="bool" value="true"/>
  <Parameter name="grid_option" type="string" value="Unstructured"/>

  <!-- Mesh List - see ??? for info -->
  <ParameterList name="Mesh">
    <Parameter isUsed="true" name="Framework" type="string" value="MSTK"/>
    <!-- stk mesh enables easy generation of the mesh.  Is this true for all classes? -etc -->
    <ParameterList name="Read Mesh File">
        <Parameter name="File" type="string" value="../mesh_fsets-4-vert/rg_mesh_fsets.par"/>
        <Parameter name="Format" type="string" value="Exodus II"/>  
    </ParameterList>
   
    <ParameterList name="Surface Mesh">
      <Parameter name="surface sideset name" type="string" value="surface"/>
      <ParameterList name="Expert">
        <Parameter name="Verify Mesh" type="bool" value="false"/>
      </ParameterList>
    </ParameterList>
  </ParameterList>

  <ParameterList name="Domain">
    <Parameter name="Spatial Dimension" type="int" value="3"/>
  </ParameterList>

  <ParameterList name="Regions">
    <!-- region for the overall domain -->
    <ParameterList name="computational domain">
      <ParameterList name="Region: Box">
        <Parameter name="Low Coordinate" type="Array(double)" value="{0.0,0.0,-45.0}"/>
        <Parameter name="High Coordinate" type="Array(double)" value="{1.0,0.7,5.0}"/>
      </ParameterList>
    </ParameterList>

    <ParameterList name="surface domain">
      <ParameterList name="Region: Box">
        <Parameter name="Low Coordinate" type="Array(double)" value="{0.0,0.0}"/>
        <Parameter name="High Coordinate" type="Array(double)" value="{1.0,1.0}"/>
      </ParameterList>
    </ParameterList>

    <ParameterList name="computational domain moss">
      <ParameterList name="Region: Labeled Set">
        <Parameter name="Label"  type="string" value="10000"/>
        <Parameter name="File"   type="string" value="../mesh_fsets-4-vert/rg_mesh_fsets.par"/>
        <Parameter name="Format" type="string" value="Exodus II"/>
        <Parameter name="Entity" type="string" value="Cell"/>
      </ParameterList>
    </ParameterList>

    <ParameterList name="computational domain peat">
      <ParameterList name="Region: Labeled Set">
        <Parameter name="Label"  type="string" value="20000"/>
        <Parameter name="File"   type="string" value="../mesh_fsets-4-vert/rg_mesh_fsets.par"/>
        <Parameter name="Format" type="string" value="Exodus II"/>
        <Parameter name="Entity" type="string" value="Cell"/>
      </ParameterList>
    </ParameterList>

    <ParameterList name="computational domain upper mineral">
      <ParameterList name="Region: Labeled Set">
        <Parameter name="Label"  type="string" value="30000"/>
        <Parameter name="File"   type="string" value="../mesh_fsets-4-vert/rg_mesh_fsets.par"/>
        <Parameter name="Format" type="string" value="Exodus II"/>
        <Parameter name="Entity" type="string" value="Cell"/>
      </ParameterList>
    </ParameterList>

    <ParameterList name="computational domain lower organic">
      <ParameterList name="Region: Labeled Set">
        <Parameter name="Label"  type="string" value="40000"/>
        <Parameter name="File"   type="string" value="../mesh_fsets-4-vert/rg_mesh_fsets.par"/>
        <Parameter name="Format" type="string" value="Exodus II"/>
        <Parameter name="Entity" type="string" value="Cell"/>
      </ParameterList>
    </ParameterList>

    <ParameterList name="computational domain lower mineral">
      <ParameterList name="Region: Labeled Set">
        <Parameter name="Label"  type="string" value="50000"/>
        <Parameter name="File"   type="string" value="../mesh_fsets-4-vert/rg_mesh_fsets.par"/>
        <Parameter name="Format" type="string" value="Exodus II"/>
        <Parameter name="Entity" type="string" value="Cell"/>
      </ParameterList>
    </ParameterList>

    <ParameterList name="computational domain deep mineral">
      <ParameterList name="Region: Labeled Set">
        <Parameter name="Label"  type="string" value="60000"/>
        <Parameter name="File"   type="string" value="../mesh_fsets-4-vert/rg_mesh_fsets.par"/>
        <Parameter name="Format" type="string" value="Exodus II"/>
        <Parameter name="Entity" type="string" value="Cell"/>
      </ParameterList>
    </ParameterList>
 
   <!-- region for the bcs -->
  
    <ParameterList name="surface">
      <ParameterList name="Region: Labeled Set">
        <Parameter name="Label"  type="string" value="2"/>
        <Parameter name="File"   type="string" value="../mesh_fsets-4-vert/rg_mesh_fsets.par"/>
        <Parameter name="Format" type="string" value="Exodus II"/>
        <Parameter name="Entity" type="string" value="Face"/>
      </ParameterList>
    </ParameterList>  

    <ParameterList name="bottom face">
      <ParameterList name="Region: Labeled Set">
        <Parameter name="Label"  type="string" value="1"/>
        <Parameter name="File"   type="string" value="../mesh_fsets-4-vert/rg_mesh_fsets.par"/>
        <Parameter name="Format" type="string" value="Exodus II"/>
        <Parameter name="Entity" type="string" value="Face"/>
      </ParameterList>
    </ParameterList>
  </ParameterList>  

  <!-- Coordinator List - see $ATS_DIR/src/coordinator/coordinator.hh -->
  <!-- Note these types of options are unusual in Amanzi and are
       currently hand-coded... don't expect this to work with most
       options.  Units features are *coming soon* -->
  <ParameterList name="coordinator">
    <Parameter name="start time" type="double" value="0.0"/>
    <Parameter name="start time units" type="string" value="s"/>
    <!-- valid units are s/d/yr -->
    <Parameter name="end time" type="double" value="3650"/>
    <Parameter name="end time units" type="string" value="d"/>
<!--    <Parameter name="end cycle" type="int" value="700"/>-->
<!--    <Parameter name="restart from checkpoint file" type="string" value="../run1-ic/checkpoint00085.h5"/>-->
  </ParameterList>

  <ParameterList name="visualization">
    <Parameter name="file name base" type="string" value="visdump"/>
    <Parameter name="times start period stop" type="Array(double)" value="{0, 86400, -1}"/>
  </ParameterList>
  <ParameterList name="visualization surface">
    <Parameter name="file name base" type="string" value="visdump_surface"/>
    <Parameter name="times start period stop" type="Array(double)" value="{0, 86400, -1}"/>
  </ParameterList>

  <!-- PK List - top level placeholder for Coordinator  -->
  <ParameterList name="PKs">
    <ParameterList name="Top level MPC">
      <Parameter name="PK type" type="string" value="weak MPC"/>
      <Parameter name="PKs order" type="Array(string)" value="{SEB,permafrost surface/subsurface}"/>

      <ParameterList name="VerboseObject">
        <Parameter name="Verbosity Level" type="string" value="extreme"/>
      </ParameterList>

      <ParameterList name="PKs">
        <ParameterList name="SEB">
          <Parameter name="PK type" type="string" value="surface balance SEB"/>
          <Parameter name="primary variable" type="string" value="snow_depth"/>
          <Parameter name="domain name" type="string" value="surface"/>
          <Parameter name="debug cells" type="Array(int)" value="{0}"/>

          <ParameterList name="VerboseObject">
            <Parameter name="Verbosity Level" type="string" value="extreme"/>
          </ParameterList>

          <Parameter name="max time step" type="double" value="86400."/>

          <!-- Initial Conditions -->
          <ParameterList name="initial condition">
            <ParameterList name="function">
              <!-- condition on a region -->
              <ParameterList name="initial head">
                <Parameter name="region" type="string" value="surface domain"/>
                <Parameter name="component" type="string" value="cell"/>
                <ParameterList name="function">
                  <!-- condition - see various functions in $AMANZI_DIR/src/functions/ -->
                  <ParameterList name="function-constant">
                    <Parameter name="value" type="double" value="0.35"/>
                  </ParameterList>
                </ParameterList>
              </ParameterList>
            </ParameterList>
          </ParameterList>
        </ParameterList>

    <ParameterList name="permafrost surface/subsurface">
      <Parameter name="PK type" type="string" value="new permafrost model no SC"/>
      <Parameter name="PKs order" type="Array(string)" value="{subsurface flow, subsurface energy, surface flow, surface energy}"/>

      <!-- predictor and preconditioner delegates -->
      <ParameterList name="subsurface ewc delegate">
        <Parameter name="predictor type" type="string" value="none"/>

        <ParameterList name="VerboseObject">
          <Parameter name="Verbosity Level" type="string" value="extreme"/>
        </ParameterList>
        <Parameter name="debug cells" type="Array(int)" value="{99}"/>
      </ParameterList>

      <ParameterList name="surface ewc delegate">
        <Parameter name="predictor type" type="string" value="smart ewc"/>

        <ParameterList name="VerboseObject">
          <Parameter name="Verbosity Level" type="string" value="extreme"/>
        </ParameterList>
        <Parameter name="debug cells" type="Array(int)" value="{0}"/>
      </ParameterList>

      <ParameterList name="water delegate">
	<Parameter name="modify predictor damp and cap the water spurt" type="bool" value="true"/>
	<Parameter name="damp and cap the water spurt" type="bool" value="true"/>
<!--      <Parameter name="damp and cap the water spurt" type="bool" value="true"/>-->
<!--      <Parameter name="cap the water spurt" type="bool" value="true"/>-->
<!--      <Parameter name="damp the water spurt" type="bool" value="true"/>-->
        <Parameter name="cap over atmospheric" type="double" value=".1"/>
<!--      <Parameter name="global water face limiter" type="double" value="30000."/>-->
        <ParameterList name="VerboseObject">
          <Parameter name="Verbosity Level" type="string" value="extreme"/>
        </ParameterList>
      </ParameterList>

      <ParameterList name="VerboseObject">
        <Parameter name="Verbosity Level" type="string" value="extreme"/>
      </ParameterList>

      <ParameterList name="Coupled PC">
        <ParameterList name="preconditioner">
          <Parameter name="preconditioner type" type="string" value="block ilu"/>
          <ParameterList name="boomer amg parameters">
            <Parameter name="number of cycles" type="int" value="10"/>
            <Parameter name="number of smoothing iterations" type="int" value="2"/>
            <Parameter name="strong threshold" type="double" value="0.5"/>
            <Parameter name="tolerance" type="double" value="0.0"/>
          </ParameterList>
          <ParameterList name="ml parameters">
            <Parameter name="smoother: type" type="string" value="ILU"/>
            <Parameter name="smoother: sweeps" type="int" value="2"/>
            <Parameter name="cycle applications" type="int" value="10"/>
          </ParameterList>
        </ParameterList>
      </ParameterList>

      <ParameterList name="Coupled Solver">
        <Parameter name="iterative method" type="string" value="nka"/>
        <Parameter name="tolerance" type="double" value="1.e-6"/>
        <Parameter name="max iterations" type="int" value="100"/>
        <ParameterList name="VerboseObject">
          <Parameter name="Verbosity Level" type="string" value="medium"/>
        </ParameterList>
      </ParameterList>


      <ParameterList name="time integrator">
        <!-- nonlinear solver -->
        <Parameter name="nonlinear solver" type="string" value="NKA BT"/>
        <Parameter name="nonlinear tolerance" type="double" value="1.e-6"/>
        <Parameter name="convergence monitor" type="string" value="monitor residual"/>

        <!-- diverging criteria -->
        <Parameter name="limit iterations" type="int" value="21"/>
        <Parameter name="diverged tolerance" type="double" value="1.e3"/>
        <Parameter name="max error growth factor" type="double" value="1.e3"/>
        <Parameter name="max divergent interations" type="int" value="5"/>

        <!-- backtracking control -->
        <Parameter name="max backtrack steps" type="int" value="20"/>
        <Parameter name="backtrack factor" type="double" value="0.5"/>
        <Parameter name="backtrack tolerance" type="double" value="1.e-5"/>
        <Parameter name="backtrack lag" type="int" value="0"/>
        <Parameter name="nka lag iterations" type="int" value="2"/>

        <!-- predictor step -->
        <Parameter name="extrapolate initial guess" type="bool" value="true"/>

        <!-- timestep control -->
        <Parameter name="timestep controller type" type="string" value="smarter"/>
        <Parameter name="max iterations" type="int" value="18"/>
        <Parameter name="min iterations" type="int" value="10"/>
        <Parameter name="time step reduction factor" type="double" value="0.75"/>
        <Parameter name="time step increase factor" type="double" value="1.25"/>
        <Parameter name="max time step" type="double" value="8640"/>
        <Parameter name="min time step" type="double" value="1.e-10"/>
        <Parameter name="growth wait after fail" type="int" value="2"/>
        <Parameter name="count before increasing increase factor" type="int" value="2"/>

        <!-- preconditioner update control -->
        <Parameter name="preconditioner lag iterations" type="int" value="0"/>

        <ParameterList name="VerboseObject">
          <Parameter name="Verbosity Level" type="string" value="extreme"/>
        </ParameterList>
      </ParameterList>

      <ParameterList name="PKs">
        <!-- Permafrost flow PK -->
        <ParameterList name="subsurface flow">
          <Parameter name="PK type" type="string" value="permafrost flow"/>
          <Parameter name="primary variable" type="string" value="pressure"/>
          <Parameter name="flux tolerance" type="double" value="1.e-1"/>
          <Parameter name="absolute error tolerance" type="double" value="1.0"/>
          <Parameter name="relative error tolerance" type="double" value="1.0"/>
          <Parameter name="initial time step" type="double" value="8640."/>
          <Parameter name="relative permeability method" type="string" value="upwind with Darcy flux"/>
          <Parameter name="permeability rescaling" type="double" value="1.e7"/>
          <Parameter name="debug cells" type="Array(int)" value="{99}"/>

          <ParameterList name="VerboseObject">
            <Parameter name="Verbosity Level" type="string" value="extreme"/>
          </ParameterList>

          <!-- MFD div (K grad p + g) term -->
          <ParameterList name="Diffusion">
            <Parameter name="MFD method" type="string" value="two point flux"/>
            <Parameter name="scaled constraint equation" type="bool" value="false"/>
            <ParameterList name="preconditioner">
              <Parameter name="preconditioner type" type="string" value="block ilu"/>
            </ParameterList>
            <ParameterList name="consistent face solver">
              <Parameter name="iterative method" type="string" value="nka"/>
              <ParameterList name="preconditioner">
                <Parameter name="preconditioner type" type="string" value="block ilu"/>
              </ParameterList>
            </ParameterList>
          </ParameterList>

          <ParameterList name="Diffusion PC">
            <Parameter name="MFD method" type="string" value="two point flux"/>
            <Parameter name="scaled constraint equation" type="bool" value="false"/>
            <ParameterList name="preconditioner">
              <Parameter name="preconditioner type" type="string" value="block ilu"/>
            </ParameterList>
            <ParameterList name="consistent face solver">
              <Parameter name="iterative method" type="string" value="nka"/>
              <ParameterList name="preconditioner">
                <Parameter name="preconditioner type" type="string" value="block ilu"/>
              </ParameterList>
            </ParameterList>
          </ParameterList>

          <!-- Boundary Conditions -->
          <ParameterList name="boundary conditions">
          </ParameterList>

          <!-- Initial Conditions -->
          <ParameterList name="initial condition">
            <Parameter name="restart file" type="string" value="../ic-3-2/checkpoint00025.h5"/>
          </ParameterList>

          <!-- Constitutive Relations -->
          <ParameterList name="water retention evaluator">
            <Parameter name="minimum rel perm cutoff" type="double" value="0."/>
            <ParameterList name="WRM parameters">
           
              <ParameterList name="moss">
                <Parameter name="region" type="string" value="computational domain moss"/>
                <Parameter name="WRM Type" type="string" value="van Genuchten"/>
                <Parameter name="van Genuchten alpha" type="double" value="0.00235"/>
                <Parameter name="van Genuchten m" type="double" value="0.275362319"/>
                <Parameter name="residual saturation" type="double" value="0.055555556"/>
                <Parameter name="smoothing interval width" type="double" value="0.0"/>
              </ParameterList>

              <ParameterList name="peat">
                <Parameter name="region" type="string" value="computational domain peat"/>
                <Parameter name="WRM Type" type="string" value="van Genuchten"/>
                <Parameter name="van Genuchten alpha" type="double" value="8.20e-06"/>
                <Parameter name="van Genuchten m" type="double" value="0.473684211"/>
                <Parameter name="residual saturation" type="double" value="0.047058824"/>
                <Parameter name="smoothing interval width" type="double" value="0.0"/>
              </ParameterList>

              <ParameterList name="upper mineral">
                <Parameter name="region" type="string" value="computational domain upper mineral"/>
                <Parameter name="WRM Type" type="string" value="van Genuchten"/>
                <Parameter name="van Genuchten alpha" type="double" value="0.000545"/>
                <Parameter name="van Genuchten m" type="double" value="0.190938511"/>
                <Parameter name="residual saturation" type="double" value="0.1"/>
                <Parameter name="smoothing interval width" type="double" value="100.0"/>
              </ParameterList>

              <ParameterList name="lower organic">
                <Parameter name="region" type="string" value="computational domain lower organic"/>
                <Parameter name="WRM Type" type="string" value="van Genuchten"/>
                <Parameter name="van Genuchten alpha" type="double" value="0.000545"/>
                <Parameter name="van Genuchten m" type="double" value="0.190938511"/>
                <Parameter name="residual saturation" type="double" value="0.1"/>
                <Parameter name="smoothing interval width" type="double" value="100.0"/>
              </ParameterList>

              <ParameterList name="lower mineral">
                <Parameter name="region" type="string" value="computational domain lower mineral"/>
                <Parameter name="WRM Type" type="string" value="van Genuchten"/>
                <Parameter name="van Genuchten alpha" type="double" value="0.000545"/>
                <Parameter name="van Genuchten m" type="double" value="0.190938511"/>
                <Parameter name="residual saturation" type="double" value="0.1"/>
                <Parameter name="smoothing interval width" type="double" value="100.0"/>
              </ParameterList>

              <ParameterList name="deep mineral">
                <Parameter name="region" type="string" value="computational domain deep mineral"/>
                <Parameter name="WRM Type" type="string" value="van Genuchten"/>
                <Parameter name="van Genuchten alpha" type="double" value="0.000545"/>
                <Parameter name="van Genuchten m" type="double" value="0.190938511"/>
                <Parameter name="residual saturation" type="double" value="0.1"/>
                <Parameter name="smoothing interval width" type="double" value="100.0"/>
              </ParameterList>
            </ParameterList>

            <ParameterList name="permafrost model parameters">
              <Parameter name="permafrost WRM type" type="string" value="fpd permafrost model"/>
              <Parameter name="minimum dsi_dpressure magnitude" type="double" value="1.e-12"/>
            </ParameterList>
            <ParameterList name="VerboseObject">
              <Parameter name="Verbosity Level" type="string" value="low"/>
            </ParameterList>
          </ParameterList>

        </ParameterList> <!-- end PK subsurface flow -->

        <ParameterList name="surface flow">
          <Parameter name="PK type" type="string" value="overland flow with ice"/>
          <Parameter name="primary variable" type="string" value="surface_pressure"/>
          <Parameter name="domain name" type="string" value="surface"/>
          <Parameter name="source term" type="bool" value="true"/>
          <Parameter name="modify predictor with consistent faces" type="bool" value="true"/>
          <Parameter name="initial time step" type="double" value="86400."/>
          <Parameter name="absolute error tolerance" type="double" value="1.0"/>
          <Parameter name="relative error tolerance" type="double" value="1.0"/>
          <Parameter name="debug cells" type="Array(int)" value="{0}"/>

          <ParameterList name="VerboseObject">
            <Parameter name="Verbosity Level" type="string" value="extreme"/>
          </ParameterList>


          <!-- MFD div (K grad p + g) term -->
          <ParameterList name="Diffusion">
            <Parameter name="TPFA" type="bool" value="true"/>
            <Parameter name="MFD method" type="string" value="two point flux"/>
            <Parameter name="scaled constraint equation" type="bool" value="true"/>
            <ParameterList name="preconditioner">
              <Parameter name="preconditioner type" type="string" value="block ilu"/>
            </ParameterList>
            <ParameterList name="consistent face solver">
              <Parameter name="iterative method" type="string" value="nka"/>
              <ParameterList name="preconditioner">
                <Parameter name="preconditioner type" type="string" value="block ilu"/>
              </ParameterList>
            </ParameterList>
          </ParameterList>

          <ParameterList name="Diffusion PC">
            <Parameter name="MFD method" type="string" value="two point flux"/>
            <Parameter name="TPFA" type="bool" value="true"/>
            <Parameter name="TPFA use full Jacobian" type="bool" value="true"/>
            <Parameter name="scaled constraint equation" type="bool" value="true"/>
            <ParameterList name="preconditioner">
              <Parameter name="preconditioner type" type="string" value="block ilu"/>
            </ParameterList>
            <ParameterList name="consistent face solver">
              <Parameter name="iterative method" type="string" value="nka"/>
              <ParameterList name="preconditioner">
                <Parameter name="preconditioner type" type="string" value="block ilu"/>
              </ParameterList>
            </ParameterList>
          </ParameterList>

          <ParameterList name="boundary conditions">
          </ParameterList>

          <!-- Initial Conditions -->
          <ParameterList name="initial condition">
            <Parameter name="initialize surface head from subsurface" type="bool" value="true"/>
          </ParameterList>

          <!-- model evaluators -->
          <ParameterList name="overland conductivity evaluator">
            <ParameterList name="overland conductivity model">
              <Parameter name="Manning exponent" type="double" value="0.6666666666666667"/>
              <Parameter name="slope regularization epsilon" type="double" value="1.e-6"/>
            </ParameterList>
          </ParameterList>

          <!-- .. unfrozen fraction model, partitions water between liquid/ice -->
          <ParameterList name="unfrozen fraction evaluator">
            <ParameterList name="unfrozen fraction model">
              <Parameter name="transition width" type="double" value="1."/>
            </ParameterList>
          </ParameterList>

          <!-- .. unfrozen fraction krel, determines the conductivity of ice to subsurface -->
          <ParameterList name="unfrozen fraction rel perm evaluator">
            <ParameterList name="unfrozen fraction rel perm model">
              <Parameter name="unfrozen rel perm alpha" type="int" value="4"/>
              <Parameter name="unfrozen rel perm cutoff height" type="double" value="0.005"/>
            </ParameterList>
          </ParameterList>


        </ParameterList> <!-- end PK surface flow -->

        <!-- Permafrost energy PK -->
        <ParameterList name="subsurface energy">
          <Parameter name="PK type" type="string" value="three-phase energy"/>
          <Parameter name="primary variable" type="string" value="temperature"/>
          <Parameter name="source term" type="bool" value="false"/>
          <Parameter name="initial time step" type="double" value="86400."/>
          <Parameter name="absolute error tolerance" type="double" value="1.0"/>
          <Parameter name="relative error tolerance" type="double" value="1.0"/>
          <Parameter name="flux tolerance" type="double" value="1.e-1"/>
          <Parameter name="debug cells" type="Array(int)" value="{99}"/>

          <ParameterList name="VerboseObject">
            <Parameter name="Verbosity Level" type="string" value="extreme"/>
          </ParameterList>

          <!-- Advection Operator -->
          <ParameterList name="Advection">
            <Parameter name="Advection method" type="string" value="donor upwind"/>
          </ParameterList>

          <!-- MFD Diffusion Operator -->
          <ParameterList name="Diffusion">
            <Parameter name="MFD method" type="string" value="two point flux"/>
            <ParameterList name="preconditioner">
              <Parameter name="preconditioner type" type="string" value="block ilu"/>
            </ParameterList>
            <ParameterList name="consistent face solver">
              <Parameter name="iterative method" type="string" value="nka"/>
              <ParameterList name="preconditioner">
                <Parameter name="preconditioner type" type="string" value="block ilu"/>
              </ParameterList>
            </ParameterList>
          </ParameterList>

          <!-- PC for the full system built from another Diffusion Operator -->
          <ParameterList name="Diffusion PC">
            <Parameter name="MFD method" type="string" value="two point flux"/>
            <ParameterList name="preconditioner">
              <Parameter name="preconditioner type" type="string" value="block ilu"/>
            </ParameterList>
            <ParameterList name="consistent face solver">
              <Parameter name="iterative method" type="string" value="nka"/>
              <ParameterList name="preconditioner">
                <Parameter name="preconditioner type" type="string" value="block ilu"/>
              </ParameterList>
            </ParameterList>
          </ParameterList>

          <!-- BCs - see ATS_DIR/src/pks/energy/bc_factory/energy_bc_factory.hh -->
          <ParameterList name="boundary conditions">
            <!-- Neuman BCs -->
            <ParameterList name="temperature">
              <ParameterList name="bottom">
                <Parameter name="regions" type="Array(string)" value="{bottom face}"/>
                <ParameterList name="boundary temperature">
                  <ParameterList name="function-constant">
                    <Parameter name="value" type="double" value="258.15"/>
                  </ParameterList>
                </ParameterList>
              </ParameterList>
            </ParameterList>
          </ParameterList>

          <!-- Initial conditions -->
          <ParameterList name="initial condition">
            <Parameter name="restart file" type="string" value="../ic-3-2/checkpoint00025.h5"/>
          </ParameterList>

          <!-- Thermal conductivity -->
          <ParameterList name="thermal conductivity evaluator">
            <ParameterList name="thermal conductivity parameters">
            
              <ParameterList name="computational domain moss">
                <Parameter name="region" type="string" value="computational domain moss"/>
                <Parameter name="thermal conductivity type" type="string" value="three-phase wet/dry"/>
                <Parameter name="thermal conductivity, saturated (unfrozen)" type="double" value="0.57"/>
                <Parameter name="thermal conductivity, dry" type="double" value="0.07"/>
                <Parameter name="unsaturated alpha frozen" type="double" value="1.0"/>
                <Parameter name="unsaturated alpha unfrozen" type="double" value="0.5"/>
              </ParameterList>

             <ParameterList name="computational domain peat">
                <Parameter name="region" type="string" value="computational domain peat"/>
                <Parameter name="thermal conductivity type" type="string" value="three-phase wet/dry"/>
                <Parameter name="thermal conductivity, saturated (unfrozen)" type="double" value="0.67"/>
                <Parameter name="thermal conductivity, dry" type="double" value="0.07"/>
                <Parameter name="unsaturated alpha frozen" type="double" value="1.0"/>
                <Parameter name="unsaturated alpha unfrozen" type="double" value="0.5"/>
              </ParameterList>

              <ParameterList name="computational domain upper mineral">
                <Parameter name="region" type="string" value="computational domain upper mineral"/>
                <Parameter name="thermal conductivity type" type="string" value="three-phase wet/dry"/>
                <Parameter name="thermal conductivity, saturated (unfrozen)" type="double" value="1.0"/>
                <Parameter name="thermal conductivity, dry" type="double" value="0.29"/>
                <Parameter name="unsaturated alpha frozen" type="double" value="1.0"/>
                <Parameter name="unsaturated alpha unfrozen" type="double" value="0.5"/>
              </ParameterList>

              <ParameterList name="computational domain lower organic">
                <Parameter name="region" type="string" value="computational domain lower organic"/>
                <Parameter name="thermal conductivity type" type="string" value="three-phase wet/dry"/>
                <Parameter name="thermal conductivity, saturated (unfrozen)" type="double" value="1.0"/>
                <Parameter name="thermal conductivity, dry" type="double" value="0.29"/>
                <Parameter name="unsaturated alpha frozen" type="double" value="1.0"/>
                <Parameter name="unsaturated alpha unfrozen" type="double" value="0.5"/>
              </ParameterList>

              <ParameterList name="computational domain lower mineral">
                <Parameter name="region" type="string" value="computational domain lower mineral"/>
                <Parameter name="thermal conductivity type" type="string" value="three-phase wet/dry"/>
                <Parameter name="thermal conductivity, saturated (unfrozen)" type="double" value="1.0"/>
                <Parameter name="thermal conductivity, dry" type="double" value="0.29"/>
                <Parameter name="unsaturated alpha frozen" type="double" value="1.0"/>
                <Parameter name="unsaturated alpha unfrozen" type="double" value="0.5"/>
              </ParameterList>

              <ParameterList name="computational domain deep mineral">
                <Parameter name="region" type="string" value="computational domain deep mineral"/>
                <Parameter name="thermal conductivity type" type="string" value="three-phase wet/dry"/>
                <Parameter name="thermal conductivity, saturated (unfrozen)" type="double" value="1.0"/>
                <Parameter name="thermal conductivity, dry" type="double" value="0.29"/>
                <Parameter name="unsaturated alpha frozen" type="double" value="1.0"/>
                <Parameter name="unsaturated alpha unfrozen" type="double" value="0.5"/>
              </ParameterList>
   
            </ParameterList>
          </ParameterList>

          <!-- advected enthalpy -->
          <ParameterList name="enthalpy evaluator">
            <Parameter name="include work term" type="bool" value="false"/>
          </ParameterList>

        </ParameterList> <!-- end PK subsurface energy -->

        <ParameterList name="surface energy">
          <Parameter name="PK type" type="string" value="surface energy"/>
          <Parameter name="primary variable" type="string" value="surface_temperature"/>
          <Parameter name="domain name" type="string" value="surface"/>
          <Parameter name="source term" type="bool" value="true"/>
          <Parameter name="flux key" type="string" value="surface_flux"/>
          <Parameter name="modify predictor with consistent faces" type="bool" value="true"/>
          <Parameter name="initial time step" type="double" value="86400."/>
          <Parameter name="absolute error tolerance" type="double" value="1.0"/>
          <Parameter name="relative error tolerance" type="double" value="1.0"/>

          <Parameter name="debug cells" type="Array(int)" value="{0}"/>

          <ParameterList name="VerboseObject">
            <Parameter name="Verbosity Level" type="string" value="extreme"/>
          </ParameterList>

          <!-- MFD div (K grad p + g) term -->
          <ParameterList name="Diffusion">
            <Parameter name="MFD method" type="string" value="two point flux"/>
            <Parameter name="TPFA" type="bool" value="true"/>
            <ParameterList name="preconditioner">
              <Parameter name="preconditioner type" type="string" value="block ilu"/>
            </ParameterList>
            <ParameterList name="consistent face solver">
              <Parameter name="iterative method" type="string" value="nka"/>
              <ParameterList name="preconditioner">
                <Parameter name="preconditioner type" type="string" value="block ilu"/>
              </ParameterList>
            </ParameterList>
          </ParameterList>

          <ParameterList name="Diffusion PC">
            <Parameter name="MFD method" type="string" value="two point flux"/>
            <Parameter name="TPFA" type="bool" value="true"/>
            <Parameter name="TPFA use full Jacobian" type="bool" value="true"/>
            <ParameterList name="preconditioner">
              <Parameter name="preconditioner type" type="string" value="block ilu"/>
            </ParameterList>
            <ParameterList name="consistent face solver">
              <Parameter name="iterative method" type="string" value="nka"/>
              <ParameterList name="preconditioner">
                <Parameter name="preconditioner type" type="string" value="block ilu"/>
              </ParameterList>
            </ParameterList>
          </ParameterList>

          <ParameterList name="Advection">
            <Parameter name="Advection method" type="string" value="donor upwind"/>
          </ParameterList>

          <!-- Initial Conditions -->
          <ParameterList name="initial condition">
            <Parameter name="initialize surface temperature from subsurface" type="bool" value="true"/>
            <Parameter name="initialize faces from cells" type="bool" value="true"/>
          </ParameterList>

          <!-- Boundary Conditions -->
          <ParameterList name="boundary conditions">
          </ParameterList>

          <!-- Thermal conductivity -->
          <ParameterList name="thermal conductivity evaluator">
            <ParameterList name="thermal conductivity parameters">
              <Parameter name="minimum thermal conductivity" type="double" value="1.e-30"/>
              <Parameter name="thermal conductivity of water" type="double" value="0.58"/>
              <Parameter name="thermal conductivity of ice" type="double" value="2.18"/>
            </ParameterList>
          </ParameterList>

          <!-- advected enthalpy -->
          <ParameterList name="enthalpy evaluator">
            <Parameter name="include work term" type="bool" value="false"/>
          </ParameterList>

        </ParameterList> <!-- end PK surface energy -->
      </ParameterList>

    </ParameterList>
  </ParameterList> <!-- end PK -->
    </ParameterList>
  </ParameterList> <!-- end PK -->

  <!-- State list - provides a few common constants and ICs for non-owned fields -->
  <ParameterList name="state">
    <ParameterList name="field evaluators">
      <!-- surface water ponded depth -->
      <ParameterList name="ponded_depth">
        <Parameter name="field evaluator type" type="string" value="icy ponded depth"/>
      </ParameterList>

      <!-- surface total source is enthalpy of mass source + conducted source -->
      <ParameterList name="surface_total_energy_source">
        <Parameter name="field evaluator type" type="string" value="advected energy source"/>
        <Parameter name="domain" type="string" value="surface"/>
        <Parameter name="include conduction" type="bool" value="true"/>
        <Parameter name="internal enthalpy key" type="string" value="surface_enthalpy"/>
        <Parameter name="external enthalpy key" type="string" value="surface_mass_source_enthalpy"/>
        <Parameter name="internal density key" type="string" value="surface_molar_density_liquid"/>
        <Parameter name="external density key" type="string" value="surface_source_molar_density"/>
        <ParameterList name="VerboseObject">
          <Parameter name="Verbosity Level" type="string" value="low"/>
        </ParameterList>
       </ParameterList>

      <!-- enthalpy of the mass source -->
      <ParameterList name="surface_mass_source_enthalpy">
        <Parameter name="field evaluator type" type="string" value="enthalpy"/>
        <Parameter name="pressure key" type="string" value="surface_effective_pressure"/>
        <Parameter name="molar density key" type="string" value="surface_source_molar_density"/>
        <Parameter name="internal energy key" type="string" value="surface_source_internal_energy"/>
        <Parameter name="include work term" type="bool" value="false"/>
        <ParameterList name="VerboseObject">
          <Parameter name="Verbosity Level" type="string" value="low"/>
        </ParameterList>
      </ParameterList>

      <!-- molar density of the mass source -->
      <ParameterList name="surface_source_molar_density">
        <Parameter name="field evaluator type" type="string" value="eos"/>
        <Parameter name="EOS basis" type="string" value="molar"/>
        <Parameter name="molar density key" type="string" value="surface_source_molar_density"/>
        <Parameter name="pressure key" type="string" value="surface_effective_pressure"/>
        <Parameter name="temperature key" type="string" value="surface_mass_source_temperature"/>
        <ParameterList name="EOS parameters">
          <Parameter name="EOS type" type="string" value="liquid water"/>
        </ParameterList>
        <ParameterList name="VerboseObject">
          <Parameter name="Verbosity Level" type="string" value="low"/>
        </ParameterList>
      </ParameterList>

      <!-- internal energy of the mass source -->
      <ParameterList name="surface_source_internal_energy">
        <Parameter name="field evaluator type" type="string" value="iem"/>
        <Parameter name="internal energy key" type="string" value="surface_source_internal_energy"/>
        <Parameter name="temperature key" type="string" value="surface_mass_source_temperature"/>
        <ParameterList name="IEM parameters">
          <Parameter name="IEM type" type="string" value="linear"/>
          <Parameter name="heat capacity [J/mol-K]" type="double" value="76.0"/>
        </ParameterList>
        <ParameterList name="VerboseObject">
          <Parameter name="Verbosity Level" type="string" value="low"/>
        </ParameterList>
      </ParameterList>

      <!-- pc_lg -->
      <ParameterList name="capillary_pressure_gas_liq">
        <Parameter name="field evaluator type" type="string" value="capillary pressure, atmospheric gas over liquid"/>
      </ParameterList>

      <!-- pc_il -->
      <ParameterList name="capillary_pressure_liq_ice">
        <Parameter name="field evaluator type" type="string" value="capillary pressure, water over ice"/>
        <ParameterList name="capillary pressure of ice-water">
          <Parameter name="interfacial tension ice-water" type="double" value="33.1"/>
          <Parameter name="interfacial tension air-water" type="double" value="72.7"/>
          <Parameter name="heat of fusion of water [J/kg]" type="double" value="3.34e5"/>
        </ParameterList>
      </ParameterList>

      <!-- Unfrozen fraction, partitioning between ice and water on the surface -->
      <ParameterList name="unfrozen_fraction">
        <Parameter name="field evaluator type" type="string" value="unfrozen fraction"/>
        <ParameterList name="unfrozen fraction model">
          <Parameter name="transition width" type="double" value="1."/>
        </ParameterList>
      </ParameterList>

      <ParameterList name="unfrozen_effective_depth">
        <Parameter name="field evaluator type" type="string" value="unfrozen effective depth"/>
      </ParameterList>

      <!-- EOS, liquid, subsurface -->
      <ParameterList name="molar_density_liquid">
        <Parameter name="field evaluator type" type="string" value="eos"/>
        <Parameter name="EOS basis" type="string" value="both"/>
        <Parameter name="molar density key" type="string" value="molar_density_liquid"/>
        <Parameter name="mass density key" type="string" value="mass_density_liquid"/>
        <ParameterList name="EOS parameters">
          <Parameter name="EOS type" type="string" value="liquid water"/>
        </ParameterList>
      </ParameterList>

      <!-- EOS, liquid, surface -->
      <ParameterList name="surface_mass_density_liquid">
        <Parameter name="field evaluator type" type="string" value="eos"/>
        <Parameter name="EOS basis" type="string" value="both"/>
        <Parameter name="molar density key" type="string" value="surface_molar_density_liquid"/>
        <Parameter name="mass density key" type="string" value="surface_mass_density_liquid"/>
        <Parameter name="pressure key" type="string" value="surface_effective_pressure"/>
        <ParameterList name="EOS parameters">
          <Parameter name="EOS type" type="string" value="liquid water"/>
        </ParameterList>
      </ParameterList>

      <!-- viscosity, liquid, subsurface -->
      <ParameterList name="viscosity_liquid">
        <Parameter name="field evaluator type" type="string" value="viscosity"/>
        <Parameter name="viscosity key" type="string" value="viscosity_liquid"/>
        <ParameterList name="viscosity model parameters">
          <Parameter name="viscosity relation type" type="string" value="liquid water"/>
        </ParameterList>
      </ParameterList>

      <!-- EOS, gas, subsurface -->
      <ParameterList name="molar_density_gas">
        <Parameter name="field evaluator type" type="string" value="eos"/>
        <Parameter name="EOS basis" type="string" value="molar"/>
        <Parameter name="molar density key" type="string" value="molar_density_gas"/>
        <ParameterList name="EOS parameters">
          <Parameter name="EOS type" type="string" value="vapor in gas"/>
          <ParameterList name="gas EOS parameters">
            <Parameter name="EOS type" type="string" value="ideal gas"/>
          </ParameterList>
        </ParameterList>
      </ParameterList>

      <!-- EOS, ice, subsurface -->
      <ParameterList name="molar_density_ice">
        <Parameter name="field evaluator type" type="string" value="eos"/>
        <Parameter name="EOS basis" type="string" value="molar"/>
        <Parameter name="molar density key" type="string" value="molar_density_ice"/>
        <ParameterList name="EOS parameters">
          <Parameter name="EOS type" type="string" value="ice"/>
        </ParameterList>
      </ParameterList>

      <!-- EOS, ice, surface -->
      <ParameterList name="surface_mass_density_ice">
        <Parameter name="field evaluator type" type="string" value="eos"/>
        <Parameter name="EOS basis" type="string" value="both"/>
        <Parameter name="molar density key" type="string" value="surface_molar_density_ice"/>
        <Parameter name="mass density key" type="string" value="surface_mass_density_ice"/>
        <Parameter name="pressure key" type="string" value="surface_effective_pressure"/>
        <ParameterList name="EOS parameters">
          <Parameter name="EOS type" type="string" value="ice"/>
        </ParameterList>
      </ParameterList>

      <!-- IEM, liquid, subsurface -->
      <ParameterList name="internal_energy_liquid">
        <Parameter name="field evaluator type" type="string" value="iem"/>
        <Parameter name="internal energy key" type="string" value="internal_energy_liquid"/>
        <ParameterList name="IEM parameters">
          <Parameter name="IEM type" type="string" value="linear"/>
          <Parameter name="heat capacity [J/mol-K]" type="double" value="76.0"/>
        </ParameterList>
      </ParameterList>

      <!-- IEM, liquid, surface -->
      <ParameterList name="surface_internal_energy_liquid">
        <Parameter name="field evaluator type" type="string" value="iem"/>
        <Parameter name="internal energy key" type="string" value="surface_internal_energy_liquid"/>
        <ParameterList name="IEM parameters">
          <Parameter name="IEM type" type="string" value="linear"/>
          <Parameter name="heat capacity [J/mol-K]" type="double" value="76.0"/>
        </ParameterList>
      </ParameterList>

      <!-- IEM, rock, subsurface -->
      <ParameterList name="internal_energy_rock">
        <Parameter name="field evaluator type" type="string" value="iem"/>
        <Parameter name="internal energy key" type="string" value="internal_energy_rock"/>
        <ParameterList name="IEM parameters">
          <Parameter name="IEM type" type="string" value="linear"/>
          <Parameter name="heat capacity [J/kg-K]" type="double" value="620.0"/>
        </ParameterList>
      </ParameterList>

      <!-- IEM, gas, subsurface -->
      <ParameterList name="internal_energy_gas">
        <Parameter name="field evaluator type" type="string" value="iem water vapor"/>
        <Parameter name="internal energy key" type="string" value="internal_energy_gas"/>
      </ParameterList>

      <!-- IEM, ice, subsurface -->
      <ParameterList name="internal_energy_ice">
        <Parameter name="field evaluator type" type="string" value="iem"/>
        <Parameter name="internal energy key" type="string" value="internal_energy_ice"/>
        <ParameterList name="IEM parameters">
          <Parameter name="IEM type" type="string" value="quadratic"/>
          <Parameter name="quadratic u_0 [J/mol]" type="double" value="-6007.87"/>
          <Parameter name="quadratic a [J/mol-K]" type="double" value="37.7841"/>
          <Parameter name="quadratic b [J/mol-K^2]" type="double" value="0.131932"/>
        </ParameterList>
      </ParameterList>

      <!-- IEM, ice, surface -->
      <ParameterList name="surface_internal_energy_ice">
        <Parameter name="field evaluator type" type="string" value="iem"/>
        <Parameter name="internal energy key" type="string" value="surface_internal_energy_ice"/>
        <ParameterList name="IEM parameters">
          <Parameter name="IEM type" type="string" value="quadratic"/>
          <Parameter name="quadratic u_0 [J/mol]" type="double" value="-6007.87"/>
          <Parameter name="quadratic a [J/mol-K]" type="double" value="37.7841"/>
          <Parameter name="quadratic b [J/mol-K^2]" type="double" value="0.131932"/>
        </ParameterList>
      </ParameterList>

      <!-- molar fraction of water in gas phase, subsurface -->
      <ParameterList name="mol_frac_gas">
        <Parameter name="field evaluator type" type="string" value="molar fraction gas"/>
        <Parameter name="molar fraction key" type="string" value="mol_frac_gas"/>
        <ParameterList name="vapor pressure model parameters">
          <Parameter name="vapor pressure model type" type="string" value="water vapor over water/ice"/>
        </ParameterList>
      </ParameterList>

      <!-- this is simply the porosity of the top layer of cells... required by SEB -->
      <!-- molar fraction of water in gas phase, subsurface -->
      <ParameterList name="surface_vapor_pressure">
        <Parameter name="field evaluator type" type="string" value="molar fraction gas"/>
        <Parameter name="molar fraction key" type="string" value="surface_vapor_pressure"/>
        <Parameter name="temperature key" type="string" value="surface_temperature"/>
        <ParameterList name="vapor pressure model parameters">
          <Parameter name="vapor pressure model type" type="string" value="water vapor over water/ice"/>
        </ParameterList>
      </ParameterList>

      <!-- surface flow conductivity parameters -->
      <ParameterList name="manning_coefficient">
        <Parameter name="field evaluator type" type="string" value="independent variable"/>
        <ParameterList name="function">
          <ParameterList name="cells">
            <Parameter name="region" type="string" value="surface domain"/>
            <Parameter name="component" type="string" value="cell"/>
            <ParameterList name="function">
              <ParameterList name="function-constant"> <!-- time component -->
                <Parameter name="value" type="double" value="0.15"/>
              </ParameterList>
            </ParameterList>
          </ParameterList>

          <ParameterList name="faces">
            <Parameter name="region" type="string" value="surface domain"/>
            <Parameter name="component" type="string" value="boundary_face"/>
            <ParameterList name="function">
              <ParameterList name="function-constant"> <!-- time component -->
                <Parameter name="value" type="double" value="0.15"/>
              </ParameterList>
            </ParameterList>
          </ParameterList>
        </ParameterList>
      </ParameterList>

      <ParameterList name="base_porosity">
        <Parameter name="field evaluator type" type="string" value="independent variable"/>
        <ParameterList name="function">
          <ParameterList name="rest domain">
            <Parameter name="region" type="string" value="computational domain"/>
            <Parameter name="component" type="string" value="cell"/>
            <ParameterList name="function">
              <ParameterList name="function-constant"> <!-- time component -->
                <Parameter name="value" type="double" value="0.5"/>
              </ParameterList>
            </ParameterList>

         <ParameterList name="moss">
            <Parameter name="region" type="string" value="computational domain moss"/>
            <Parameter name="component" type="string" value="cell"/>
            <ParameterList name="function">
              <ParameterList name="function-constant">
                <Parameter name="value" type="double" value="0.9"/>
              </ParameterList>
            </ParameterList>
          </ParameterList>

          <ParameterList name="peat">
            <Parameter name="region" type="string" value="computational domain peat"/>
            <Parameter name="component" type="string" value="cell"/>
            <ParameterList name="function">
              <ParameterList name="function-constant">
                <Parameter name="value" type="double" value="0.85"/>
              </ParameterList>
            </ParameterList>
          </ParameterList>

        </ParameterList>
        </ParameterList>
        <ParameterList name="VerboseObject">
          <Parameter name="Verbosity Level" type="string" value="low"/>
        </ParameterList>
      </ParameterList>

      <ParameterList name="porosity">
        <Parameter name="field evaluator type" type="string" value="compressible porosity"/>
        <ParameterList name="compressible porosity model parameters">
          <Parameter name="pore compressibility" type="double" value="2.5e-7"/>
        </ParameterList>
      </ParameterList>

      <!-- this is simply the porosity of the top layer of cells... required by SEB -->
      <ParameterList name="surface_porosity">
        <Parameter name="field evaluator type" type="string" value="surface top cell evaluator"/>
        <Parameter name="surface key" type="string" value="surface_porosity"/>
        <Parameter name="subsurface key" type="string" value="porosity"/>
      </ParameterList>

      <!-- abs perm -->
      <ParameterList name="permeability">
        <Parameter name="field evaluator type" type="string" value="independent variable"/>
        <ParameterList name="function">
          <ParameterList name="rest domain">
            <Parameter name="region" type="string" value="computational domain"/>
            <Parameter name="component" type="string" value="cell"/>
            <ParameterList name="function">
              <ParameterList name="function-constant"> <!-- time component -->
                <Parameter name="value" type="double" value="2.5e-12"/>
              </ParameterList>
            </ParameterList>
          </ParameterList>

          <ParameterList name="moss">
            <Parameter name="region" type="string" value="computational domain moss"/>
            <Parameter name="component" type="string" value="cell"/>
            <ParameterList name="function">
              <ParameterList name="function-constant"> <!-- time component -->
                <Parameter name="value" type="double" value="5.00e-11"/>
              </ParameterList>
            </ParameterList>
          </ParameterList>

          <ParameterList name="peat">
            <Parameter name="region" type="string" value="computational domain peat"/>
            <Parameter name="component" type="string" value="cell"/>
            <ParameterList name="function">
              <ParameterList name="function-constant"> <!-- time component -->
                <Parameter name="value" type="double" value="5.00e-12"/>
              </ParameterList>
            </ParameterList>
          </ParameterList>
        </ParameterList>
      </ParameterList>

      <ParameterList name="density_rock">
        <Parameter name="field evaluator type" type="string" value="independent variable"/>
        <ParameterList name="function">
          <ParameterList name="rest domain">
            <Parameter name="region" type="string" value="computational domain"/>
            <Parameter name="component" type="string" value="cell"/>
            <ParameterList name="function">
              <ParameterList name="function-constant"> <!-- time component -->
                <Parameter name="value" type="double" value="2000."/>
              </ParameterList>
            </ParameterList>
          </ParameterList>

          <ParameterList name="moss">
            <Parameter name="region" type="string" value="computational domain moss"/>
            <Parameter name="component" type="string" value="cell"/>
            <ParameterList name="function">
              <ParameterList name="function-constant"> <!-- time component -->
                <Parameter name="value" type="double" value="400"/>
              </ParameterList>
            </ParameterList>
          </ParameterList>

          <ParameterList name="peat">
            <Parameter name="region" type="string" value="computational domain peat"/>
            <Parameter name="component" type="string" value="cell"/>
            <ParameterList name="function">
              <ParameterList name="function-constant"> <!-- time component -->
                <Parameter name="value" type="double" value="700"/>
              </ParameterList>
            </ParameterList>
          </ParameterList>
        </ParameterList>
      </ParameterList>

      <!-- effective pressure, max(p, p_atm), subsurface -->
      <ParameterList name="effective_pressure">
        <Parameter name="field evaluator type" type="string" value="effective_pressure"/>
      </ParameterList>

      <!-- effective pressure, max(p, p_atm), surface -->
      <ParameterList name="surface_effective_pressure">
        <Parameter name="field evaluator type" type="string" value="effective_pressure"/>
      </ParameterList>

<!--
      <ParameterList name="surface_mass_source">
        <Parameter name="field evaluator type" type="string" value="independent variable"/>
        <ParameterList name="function">
          <ParameterList name="domain">
            <Parameter name="region" type="string" value="surface domain"/>
            <Parameter name="component" type="string" value="cell"/>
            <ParameterList name="function">
              <ParameterList name="function-constant">
                <Parameter name="value" type="double" value="1.e-7"/>
              </ParameterList>
            </ParameterList>
          </ParameterList>
        </ParameterList>
      </ParameterList>

      <ParameterList name="surface_mass_source_temperature">
        <Parameter name="field evaluator type" type="string" value="independent variable"/>
        <ParameterList name="function">
          <ParameterList name="domain">
            <Parameter name="region" type="string" value="surface domain"/>
            <Parameter name="component" type="string" value="cell"/>
            <ParameterList name="function">
              <ParameterList name="function-constant">
                <Parameter name="value" type="double" value="273.15"/>
              </ParameterList>
            </ParameterList>
          </ParameterList>
        </ParameterList>
      </ParameterList>

      <ParameterList name="surface_conducted_energy_source">
        <Parameter name="field evaluator type" type="string" value="independent variable"/>
        <ParameterList name="function">
          <ParameterList name="domain">
            <Parameter name="region" type="string" value="surface domain"/>
            <Parameter name="component" type="string" value="cell"/>
            <ParameterList name="function">
              <ParameterList name="function-constant">
                <Parameter name="value" type="double" value="0."/>
              </ParameterList>
            </ParameterList>
          </ParameterList>
        </ParameterList>
      </ParameterList>
-->
      <ParameterList name="surface_conducted_energy_source">
        <Parameter name="field evaluator type" type="string" value="surface balance SEB"/>
      </ParameterList>



      <!-- Met Data   -->
      <ParameterList name="incoming_shortwave_radiation">
        <Parameter name="field evaluator type" type="string" value="independent variable"/>
        <ParameterList name="function">
          <ParameterList name="domain">
            <Parameter name="region" type="string" value="surface domain"/>
            <Parameter name="component" type="string" value="cell"/>
            <ParameterList name="function">
              <ParameterList name="function-tabular"> <!-- time component -->
                <Parameter name="file" type="string" value="10yr-WinterStartRAW.h5"/>
                <Parameter name="x header" type="string" value="/time"/>
                <Parameter name="y header" type="string" value="/QswIn"/>
              </ParameterList>
            </ParameterList>
          </ParameterList>
        </ParameterList>
        <ParameterList name="VerboseObject">
          <Parameter name="Verbosity Level" type="string" value="low"/>
        </ParameterList>
      </ParameterList>

      <ParameterList name="air_temperature">
        <Parameter name="field evaluator type" type="string" value="independent variable"/>
        <ParameterList name="function">
          <ParameterList name="domain">
            <Parameter name="region" type="string" value="surface domain"/>
            <Parameter name="component" type="string" value="cell"/>
            <ParameterList name="function">
              <ParameterList name="function-tabular"> <!-- time component -->
                <Parameter name="file" type="string" value="10yr-WinterStartRAW.h5"/>
                <Parameter name="x header" type="string" value="/time"/>
                <Parameter name="y header" type="string" value="/Ta"/>
              </ParameterList>
            </ParameterList>
          </ParameterList>
        </ParameterList>
        <ParameterList name="VerboseObject">
          <Parameter name="Verbosity Level" type="string" value="low"/>
        </ParameterList>
      </ParameterList>


      <ParameterList name="relative_humidity">
        <Parameter name="field evaluator type" type="string" value="independent variable"/>
        <ParameterList name="function">
          <ParameterList name="domain">
            <Parameter name="region" type="string" value="surface domain"/>
            <Parameter name="component" type="string" value="cell"/>
            <ParameterList name="function">
              <ParameterList name="function-tabular"> <!-- time component -->
                <Parameter name="file" type="string" value="10yr-WinterStartRAW.h5"/>
                <Parameter name="x header" type="string" value="/time"/>
                <Parameter name="y header" type="string" value="/RH"/>
              </ParameterList>
            </ParameterList>
          </ParameterList>
        </ParameterList>
        <ParameterList name="VerboseObject">
          <Parameter name="Verbosity Level" type="string" value="low"/>
        </ParameterList>
      </ParameterList>

      <ParameterList name="wind_speed">
        <Parameter name="field evaluator type" type="string" value="independent variable"/>
        <ParameterList name="function">
          <ParameterList name="domain">
            <Parameter name="region" type="string" value="surface domain"/>
            <Parameter name="component" type="string" value="cell"/>
            <ParameterList name="function">
              <ParameterList name="function-tabular"> <!-- time component -->
                <Parameter name="file" type="string" value="10yr-WinterStartRAW.h5"/>
                <Parameter name="x header" type="string" value="/time"/>
                <Parameter name="y header" type="string" value="/Us"/>
              </ParameterList>
            </ParameterList>
          </ParameterList>
        </ParameterList>
        <ParameterList name="VerboseObject">
          <Parameter name="Verbosity Level" type="string" value="low"/>
        </ParameterList>
      </ParameterList>

      <ParameterList name="precipitation_rain">
        <Parameter name="field evaluator type" type="string" value="independent variable"/>
        <ParameterList name="function">
          <ParameterList name="domain">
            <Parameter name="region" type="string" value="surface domain"/>
            <Parameter name="component" type="string" value="cell"/>
            <ParameterList name="function">
              <ParameterList name="function-tabular"> <!-- time component -->
                <Parameter name="file" type="string" value="10yr-WinterStartRAW.h5"/>
                <Parameter name="x header" type="string" value="/time"/>
                <Parameter name="y header" type="string" value="Pr"/>
              </ParameterList>
            </ParameterList>
          </ParameterList>
        </ParameterList>
        <ParameterList name="VerboseObject">
          <Parameter name="Verbosity Level" type="string" value="low"/>
        </ParameterList>
      </ParameterList>

      <ParameterList name="precipitation_snow">
        <Parameter name="field evaluator type" type="string" value="independent variable"/>
        <ParameterList name="function">
          <ParameterList name="domain">
            <Parameter name="region" type="string" value="surface domain"/>
            <Parameter name="component" type="string" value="cell"/>
            <ParameterList name="function">
              <ParameterList name="function-tabular"> <!-- time component -->
                <Parameter name="file" type="string" value="10yr-WinterStartRAW.h5"/>
                <Parameter name="x header" type="string" value="/time"/>
                <Parameter name="y header" type="string" value="Ps"/>
              </ParameterList>
            </ParameterList>
          </ParameterList>
        </ParameterList>
        <ParameterList name="VerboseObject">
          <Parameter name="Verbosity Level" type="string" value="low"/>
        </ParameterList>
      </ParameterList>

    </ParameterList>

    <ParameterList name="initial conditions">
      <ParameterList name="atmospheric_pressure">
        <Parameter name="value" type="double" value="101325.0"/>
      </ParameterList>

      <ParameterList name="gravity">
        <Parameter name="value" type="Array(double)" value="{0.0, 0.0, -9.80665}"/>
      </ParameterList>

    </ParameterList>
  </ParameterList>

</ParameterList>

